(function(){"use strict";var t=typeof jQuery==typeof undefined?null:jQuery,n=function(n,t){if(n){var r={menuItems:[],menuItemClasses:[],contextMenuClasses:[]},i;n("core","contextMenus",function(n){function nt(n,t){var r={};for(var i in n)r[i]=n[i];for(i in t)r[i]=t[i];return r}function o(n){return e.scratch("cycontextmenus")[n]}function f(n,t){e.scratch("cycontextmenus")[n]=t}function tt(){t(".cy-context-menus-cxt-menu").contextmenu(function(){return!1})}function it(n,t){var i=a(n);return i+=" "+g,t&&(i+=" "+c),i}function a(n){for(var r,i="",t=0;t<n.length;t++)r=n[t],i+=r,t!==n.length-1&&(i+=" ");return i}function l(n){n.css("display","block")}function h(n){n.css("display","none")}function rt(){u.children().css("display","none")}function ut(n,t){var i;n.on("click",i=function(){t(o("currentCyEvent"))});n.data("call-on-click-function",i)}function ft(n,t,i){function r(t){f("currentCyEvent",t);ot(t);n.data("show")&&(u.is(":visible")||l(u),f("anyVisibleChild",!0),l(n));!o("anyVisibleChild")&&u.is(":visible")&&h(u)}var s,c;if(i)e.on("cxttap",c=function(n){var t=n.target||n.cyTarget;t==e&&r(n)});if(t)e.on("cxttap",t,s=function(n){r(n)});n.data("cy-context-menus-cxtfcn",s);n.data("cy-context-menus-cxtcorefcn",c)}function et(){e.on("tapstart",i=function(){h(u);f("cxtMenuPosition",undefined);f("currentCyEvent",undefined)})}function v(n,t,i,r){ut(n,t);ft(n,i,r)}function ot(n){var h=o("cxtMenuPosition"),i=n.position||n.cyPosition;if(h!=i){rt();f("anyVisibleChild",!1);f("cxtMenuPosition",i);var r=t(e.container()).offset(),s=n.renderedPosition||n.cyRenderedPosition,c=r.left+s.x,l=r.top+s.y;u.css("left",c);u.css("top",l)}}function y(n){for(var t=0;t<n.length;t++)p(n[t])}function p(n){var t=w(n);ct(t);v(t,n.onClickFunction,n.selector,n.coreAsWell)}function st(n,t){var i=w(n);lt(i,t);v(i,n.onClickFunction,n.selector,n.coreAsWell)}function ht(){var n=a(s.contextMenuClasses);return u=t("<div class="+n+"><\/div>"),u.addClass("cy-context-menus-cxt-menu"),f("cxtMenu",u),t("body").append(u),u}function w(n){var u=it(s.menuItemClasses,n.hasTrailingDivider),r='<button id="'+n.id+'" class="'+u+'"',i;return n.tooltipText&&(r+=' title="'+n.tooltipText+'"'),n.disabled&&(r+=" disabled"),r+=n.image?'><img src="'+n.image.src+'" width="'+n.image.width+'px"; height="'+n.image.height+'px"; style="position:absolute; top: '+n.image.y+"px; left: "+n.image.x+'px;">'+n.content+"<\/button>":">"+n.content+"<\/button>",i=t(r),i.data("selector",n.selector),i.data("on-click-function",n.onClickFunction),i.data("show",typeof n.show=="undefined"||n.show),i}function ct(n){u.append(n);yt(n)}function lt(n,i){var r=t("#"+i);n.insertBefore(r)}function b(){o("active")&&(at(),e.off("tapstart",i),u.remove(),u=undefined,f(u,undefined),f("active",!1),f("anyVisibleChild",!1))}function at(){var n=u.children();t(n).each(function(){k(t(this))})}function k(n){var i=typeof n=="string"?t("#"+n):n,r=i.data("cy-context-menus-cxtfcn"),o=i.data("selector"),u=i.data("call-on-click-function"),f=i.data("cy-context-menus-cxtcorefcn");r&&e.off("cxttap",o,r);f&&e.off("cxttap",f);u&&i.off("click",u);i.remove()}function vt(n,i){if(n!==i){var r=t("#"+n).detach(),u=t("#"+i);r.insertBefore(u)}}function yt(n){n.click(function(){h(u);f("cxtMenuPosition",undefined)})}function pt(n){t("#"+n).attr("disabled",!0)}function wt(n){t("#"+n).attr("disabled",!1)}function bt(n,i){var r=t("#"+n);i?r.addClass(c):r.removeClass(c)}function kt(n){return{isActive:function(){return o("active")},appendMenuItem:function(t){return p(t),n},appendMenuItems:function(t){return y(t),n},removeMenuItem:function(t){return k(t),n},setTrailingDivider:function(t,i){return bt(t,i),n},insertBeforeMenuItem:function(t,i){return st(t,i),n},moveBeforeOtherMenuItem:function(t,i){return vt(t,i),n},disableMenuItem:function(t){return pt(t),n},enableMenuItem:function(t){return wt(t),n},hideMenuItem:function(i){return t("#"+i).data("show",!1),h(t("#"+i)),n},showMenuItem:function(i){return t("#"+i).data("show",!0),l(t("#"+i)),n},destroy:function(){return b(),n}}}var e=this,d;e.scratch("cycontextmenus")||e.scratch("cycontextmenus",{});var s=o("options"),u=o("cxtMenu"),g="cy-context-menus-cxt-menuitem",c="cy-context-menus-divider";return n!=="get"&&(s=nt(r,n),f("options",s),o("active")&&b(),f("active",!0),u=ht(),d=s.menuItems,y(d),et(),tt()),kt(this)})}};typeof module!="undefined"&&module.exports&&(module.exports=n);typeof define!="undefined"&&define.amd&&define("cytoscape-context-menus",function(){return n});typeof cytoscape!="undefined"&&t&&n(cytoscape,t)})();